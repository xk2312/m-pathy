@tailwind base;
@tailwind components;
@tailwind utilities;

/* Chat-typografische Erweiterung (für .md-prose) */
@import "./chat-prose.css";

/* ── Base Reset ───────────────────────────────────────────── */
* { box-sizing: border-box; margin: 0; padding: 0; }

/* Wichtig: Scroll wieder erlauben + Selektieren aktivieren */
html, body {
  width: 100%;
  min-height: 100dvh; /* dvh für Mobile-Keyboards */
  color: #fff;
  background:
    radial-gradient(circle at center, #0f0f0f, #000000);
  user-select: text;                 /* war: none */
  -webkit-user-select: text;
  touch-action: pan-y pinch-zoom;
}

/* Kein globales overflow:hidden – sonst scrollt nichts */
html { overflow-x: hidden; }
body {
  background-color: #000;
  overscroll-behavior-y: auto;
  -webkit-tap-highlight-color: transparent;
}

/* Canvas bleibt block-level */
canvas { display: block; }

/* ── Legacy Bloom-IDs: beibehalten ───────────────────────── */
#bloom-wrapper { position: relative; width: 100%; min-height: 100dvh; }
#bloom-core {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 160px; height: 160px; border-radius: 50%;
  background: rgba(112,224,255,0.05);
  transition: all 0.3s ease; z-index: 2;
}
#bloom-core.hover { box-shadow: 0 0 60px rgba(112,224,255,0.4); }
.stage-2 { background: black; transition: background 1s ease; }

/* ── Keyframes (global, stabil) ──────────────────────────── */
@keyframes zenithSweep {
  from { transform: translateX(-120%); }
  to   { transform: translateX(120%); }
}
@keyframes zenithExit {
  0%   { opacity:1; transform: translateX(-50%) translateY(0) scale(1); filter: blur(0); }
  40%  { opacity:.9; transform: translateX(-50%) translateY(-3vh) scale(1.04); }
  100% { opacity:0; transform: translateX(-50%) translateY(-20vh) scale(.9); filter: blur(6px); }
}
@keyframes zenithDust {
  0%   { opacity:.9; transform: translate(0,0) scale(1); filter: blur(0); }
  100% { opacity:0; transform: translate(var(--dx), var(--dy)) scale(0.3); filter: blur(2px); }
}

/* ── Motion/A11y ─────────────────────────────────────────── */
@media (prefers-reduced-motion: reduce){
  .btn, .btn::before, .crystal, .isExiting { transition:none !important; animation:none !important; }
}
@media (prefers-reduced-motion: reduce){
  * { animation: none !important; transition: none !important; transform: none !important; }
}

/* ── Chat-Farben (wie bei dir) ───────────────────────────── */
.message { color: #fff; }
.message.user { color: #0ff; }
.message.assistant { color: #ffd700; }

/* ── Scrollbars (dezent) ─────────────────────────────────── */
section::-webkit-scrollbar { width: 8px; }
section::-webkit-scrollbar-track { background: transparent; }
section::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 4px; }
section::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }

/* ── Hilfsklassen ────────────────────────────────────────── */
/* Falls du lokal selektieren verbieten willst: */
.no-copy { user-select: none !important; -webkit-user-select: none !important; }

/* z-Layer Konvention (für Overlays/Drawer/FAB) */
:root {
  --z-base: 1;
  --z-overlay: 60;
  --z-fab: 70;
    /* === Galaxy Design Tokens === */
  --color-bg: #0a0f14;
  --color-fg: #e6f7ff;

  /* Radii */
  --rz-sm: 10px;
  --rz-lg: 20px;
  --rz-2xl: 24px;

  /* Shadows & Glow */
  --sh-sm: 0 2px 8px rgba(0,255,255,0.10);
  --sh-md: 0 6px 24px rgba(0,255,255,0.12);
  --sh-lg: 0 12px 40px rgba(0,255,255,0.15);
  --glow: 0 0 0 1px rgba(0,255,255,0.25), 0 0 18px rgba(0,255,255,0.18);

  /* Timings & Easing */
  --t-fast: 90ms;
  --t-mid: 120ms;
  --t-slow: 200ms;
  --ease: cubic-bezier(.2,.6,.2,1);

  /* --- Safe-area Desktop Default --- */
  --safe-bottom: 0px; /* Wichtig: Desktop-Fallback = 0px */
}

/* Wenn der Browser safe-area kennt, mappe sie auf die Variable. */
@supports (padding: max(0px)) {
  :root {
    --safe-bottom: env(safe-area-inset-bottom, 0px);
  }
}


/* ======================================================================
   Markdown typographic defaults (greifen auf <div class="markdown">…)
   ====================================================================== */

.markdown {
  line-height: 1.6;
  word-break: break-word;
  color: inherit;           /* erbt Bubble-Farbe */
}

/* Headings */
.markdown h1,
.markdown h2,
.markdown h3 {
  margin: 1.2em 0 0.6em;
  font-weight: 700;
  line-height: 1.25;
}
.markdown h1 { font-size: clamp(1.40rem, 1.10rem + 1vw, 1.90rem); }
.markdown h2 { font-size: clamp(1.25rem, 1.00rem + 0.7vw, 1.60rem); }
.markdown h3 { font-size: clamp(1.10rem, 0.95rem + 0.5vw, 1.30rem); }

/* Paragraphs */
.markdown p { margin: 0.75em 0; }

/* Lists */
.markdown ul,
.markdown ol {
  display: block;           /* Schutz gegen Resets */
  list-style-position: outside;
  margin: 0.75em 0 0.75em 1.25em;
  padding: 0;
}
.markdown li { display: list-item; margin: 0.25em 0; }
.markdown ul  { list-style-type: disc; }
.markdown ul ul { margin-left: 1.1em; list-style-type: circle; }
.markdown ol  { list-style-type: decimal; }

/* Inline code */
.markdown code {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 0.9em;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.08);
  padding: 0.1em 0.35em;
  border-radius: 0.35em;
}

/* Links (optional) */
.markdown a { text-decoration: underline; color: inherit; }

/* === MOBILE SCOPE ===================================================== */
@media (max-width: 768px), (pointer: coarse) {
  :root {
    /* Viewport + Safe Area (werden später via JS aktualisiert) */
    --vh: 1vh;                         /* Fallback, wird via visualViewport gesetzt */
    --safe-bottom: env(safe-area-inset-bottom, 0px);

    /* Header-Höhen */
    --header-h-idle: 96px;
    --header-h-shrink: 72px;
    --header-h-typing: 0px;
    --header-h: var(--header-h-idle);  /* aktueller Wert (wird getoggelt) */

    /* Dock / Prompt Caps */
    --dock-cap-portrait: 30vh;
    --dock-cap-landscape: 22vh;
    --dock-cap: var(--dock-cap-portrait);

    /* Spacings */
    --header-offset: 16px;             /* Säule-Offset unter Header */
  }

  /* Motion budget mobil (respect RRM) */
  @media (prefers-reduced-motion: no-preference) {
    .mob-transition {
      transition: height .16s ease, padding .16s ease, transform .16s ease, opacity .16s ease;
    }
  }
}
/* === Mobile MessageInput Toolbar Toggle ================================ */
@media (max-width: 768px), (pointer: coarse) {
  /* Plus-Button mobil zeigen */
  .mi-plus-btn { display: inline-flex; }

  /* Rechte Icon-Leiste mobil ausblenden (nur die Toolbar, nicht den Senden-Button) */
  .m-inputbar__actionsRight [role="toolbar"] {
    display: none !important;
  }

  /* Tool-Kacheln im Popover: große Touch-Ziele */
  .mi-tool {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-height: 44px;
    border-radius: 10px;
    border: 1px solid #314156;
    background: #0b1220;
    color: #e6f0f3;
    font-weight: 700;
  }
}

/* Desktop: Plus-Button ausblenden */
@media (min-width: 769px) and (pointer: fine) {
  .mi-plus-btn { display: none !important; }
}
/* === A11y Focus Enhancements =========================================== */
:focus-visible {
  outline: 2px solid rgba(34,211,238,0.55);
  outline-offset: 2px;
}
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }
}
:root { --dock-h: 60px; } /* Fallback */
@media (max-width: 768px){
  html, body { overflow-x: hidden; }
}

/* gezielt den Chat-Scroller dunkler stylen */
div[data-convo="1"]::-webkit-scrollbar-track { background: transparent; }
@supports (scrollbar-color: auto) {
  div[data-convo="1"] { scrollbar-color: rgba(255,255,255,0.25) transparent; }
}

/* Golden Prompt Layout */
.gold-tools{
  display:flex; gap:8px; justify-content:flex-start;
  width:min(920px, 100%); margin:0 auto 6px auto;
}
.gt{
  height:32px; min-width:32px; border-radius:10px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
  color: inherit;
}
.gold-prompt-wrap{
  display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:stretch;
  width:min(920px, calc(100vw - env(safe-area-inset-left) - env(safe-area-inset-right) - 16px));
  margin:0 auto;
}
.gold-textarea{
  width:100%; min-height:44px; max-height:var(--dock-cap); resize:none;
  border-radius:12px; padding:10px 12px; line-height:1.5;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04); color: inherit; outline:none;
}
.gold-send{
  min-height:44px; align-self:stretch; border-radius:12px;
  padding:0 14px; font-weight:700; cursor:pointer;
  border:1px solid rgba(34,211,238,0.28); background: rgba(34,211,238,0.12); color: inherit;
}

/* Inertias & Ripple (wie besprochen) */
.gold-dock.send-ripple{
  animation: gp-inertia 320ms cubic-bezier(.2,.6,.2,1) 1,
             gp-ripple 680ms ease-out 1;
}
@keyframes gp-inertia{
  0%{ transform: translateY(0); } 55%{ transform: translateY(-3px); } 100%{ transform: translateY(0); }
}
@keyframes gp-ripple{
  0%{ box-shadow: 0 -6px 24px rgba(0,0,0,.35), inset 0 0 0 0 rgba(34,211,238,0); }
  15%{ box-shadow: 0 -6px 24px rgba(0,0,0,.35), inset 0 0 0 1000px rgba(34,211,238,0.08); }
  100%{ box-shadow: 0 -6px 24px rgba(0,0,0,.35), inset 0 0 0 0 rgba(34,211,238,0); }
}
/* Reserviere immer Fußraum im rechten Scroll-Container 
div[data-convo="1"] {
  padding-bottom: calc(var(--dock-h, 60px) + var(--safe-bottom, 0px) + 24px);
}
*/

/* Dock wirklich sticky am Scrollport-Rand halten */
#m-input-dock {
  position: sticky;
  bottom: var(--safe-bottom, 0px);
  z-index: var(--z-overlay, 60);
}
/* Dock zuverlässig an den Viewport pinnen (Desktop & Mobile) */
#m-input-dock {
position: fixed;
left: 0;
right: 0;
bottom: var(--safe-bottom, 0px);
z-index: var(--z-overlay, 90);
}